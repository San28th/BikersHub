<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>BikersHub</title>
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH"
      crossorigin="anonymous"
    />
    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"
      integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz"
      crossorigin="anonymous"
    ></script>
    <link href="/templates/css/productview.css" rel="stylesheet" />
  </head>
  <body>
    <div class="navedit">
      <nav class="navbar navbar-expand-lg">
        <div class="container-fluid">
          <a class="navbar-brand" href="#"
            ><img src="/templates/assets/logo.png" width="230px" height="80px"
          /></a>
          <button
            class="navbar-toggler"
            type="button"
            data-bs-toggle="collapse"
            data-bs-target="#navbarNavDropdown"
            aria-controls="navbarNavDropdown"
            aria-expanded="false"
            aria-label="Toggle navigation"
          >
            <span class="navbar-toggler-icon"></span>
          </button>
          <div
            class="collapse navbar-collapse justify-content-center"
            id="navbarNavDropdown"
          >
            <ul class="navbar-nav">
              <li class="nav-item">
                <a class="nav-link" aria-current="page" href="/get_home"
                  ><b><span>Home</span></b></a
                >
              </li>
              <li class="nav-item">
                <a class="nav-link" href="/get_product"><b>Products</b></a>
              </li>
              <li class="nav-item">
                <a class="nav-link" href="/get_about"><b>About Us</b></a>
              </li>
                            <li class="nav-item">
                <a class="nav-link" href="/get_contact"><b>Contact Us</b></a>
              </li>
              <a href="/get_profile"><div class="user-info">
                <img src="/templates/assets/chain.jpg/" alt="User Image" /></a>
                <div class="user-name">{{username}}</div>
                </ul>
              </li>
            </ul>
          </div>
        </div>
      </nav>
    </div>
    <div class="producttext">
    <span>
      <h2><b>Product: {{order.product_name}}</b></h2>
    </span>
  </div>
    <div class="container-md">
      <img class="one" src="/templates/images/{{order.image}}" alt="" />
      <div>
        <fieldset class="container two">
          <h1><b>Description:</b></h1>
          <h3>{{order.description}}</h3>
        </fieldset>
      </div>
    </div>
    <br>
    <br>
    <div class="audioali">
      <h1><b>Audio Format:</b></h1>
      <br>
          <audio class="audio1" controls>
          <source src="/templates/audios/{{order.audio}}" />
        </audio>
    </div>
    <br>
    <br>
    <div class="videoali">
      <h1><b>Video Format:</b></h1>
    </div>  
    <video class="video" controls>
      <source src="/templates/videos/{{order.video}}" />
    </video>
  
    <div class="container budget">
      
        <h2>Price Details</h2>
      <br>
      <div class="form-group">
        <label for="shipping">Name:</label>
        <input type="text" id="name" placeholder="Enter Name" />
      </div>
      <div class="form-group">
        <label for="shipping">Address:</label>
        <input type="text" id="Address" placeholder="Enter Address" />
      </div>
      <div class="form-group">
        <label for="coupon">Pincode:</label>
        <input type="text" id="Pincode" placeholder="Enter Pincode"/>
      </div>
      <div class="form-group">
        <label for="coupon">Mobile Number:</label>
        <input type="text" id="Mobile_number" placeholder="Enter MobileNo"/>
      </div>
      <div class="form-group">
        <label for="quantity">Quantity:</label>
        <div class="quantity">
          <input type="number" id="quantity" onchange="updateprice(this.value)" value="1" min="1" />
          <!-- <button onclick="increaseQuantity()">+</button>
                <button onclick="decreaseQuantity()">-</button> -->
        </div>
      </div>
      <div class="form-group">
        <label for="grand-total">Grand total:</label>
        <span id="grand_total">{{order.price}}</span>
      </div>
      <div id="paypal-button-container"></div>
    </div>

    <script>
      function proceedToCheckout() {
        // You can add your checkout logic here
        alert("Proceeding to checkout...");
      }

      function increaseQuantity() {
        var input = document.getElementById("quantity");
        input.value = parseInt(input.value) + 1;
      }

      function decreaseQuantity() {
        var input = document.getElementById("quantity");
        if (parseInt(input.value) > 1) {
          input.value = parseInt(input.value) - 1;
        }
      }
    </script>

    <footer class="site-footer">
      <div class="container">
        <div class="row">
          <div class="col-sm-12 col-md-6">
            <h6>About</h6>
            <p class="text-justify">
              Welcome to Bikers Hub, your one-stop destination for all your
              biking needs. We understand the exhilaration and joy that comes
              with riding, whether you're exploring urban streets or tackling
              challenging trails. Bikers Hub is dedicated to providing cyclists
              of all levels with top-quality accessories to elevate their riding
              experience.
            </p>
          </div>

          <div class="col-xs-6 col-md-3">
            <h6>Categories</h6>
            <ul class="footer-links">
              <li>
                <a href="/get_view/2"
                  >Spare Parts</a
                >
              </li>
              <li>
                <a href="/get_view/3"
                  >Tourist addons</a
                >
              </li>
              <li>
                <a
                  href="/get_view/6"
                  >Modification Parts</a
                >
              </li>
              <li>
                <a href="/get_view/9">Helmets</a>
              </li>
            </ul>
          </div>

          <div class="col-xs-6 col-md-3">
            <h6>Quick Links</h6>
            <ul class="footer-links">
              <li><a href="/get_about">About Us</a></li>
              <li><a href="/get_contact">Contact Us</a></li>
            </ul>
          </div>
        </div>
        <hr />
      </div>
      <div class="container">
        <div class="row">
          <div class="col-md-8 col-sm-6 col-xs-12">
            <p class="copyright-text">
              Copyright &copy; 2024 All Rights Reserved by
              <a href="#" style="text-decoration: none">Biker Hub</a>.
            </p>
          </div>
        </div>
      </div>
    </footer>
  </body>
</html>
<script src="https://www.paypal.com/sdk/js?client-id=AfjPWqTofFdrBORSLj5uWsxws2oyx-iFZE6IWDJPgWG1D8EpZJNm7DZuQHOtFSwI-zOA2pn-y6brxo1-&currency=USD"></script>
 <script src="https://code.jquery.com/jquery-3.6.4.min.js"></script>
<script>
  var pricee="{{order.price}}";
  function updateprice(count) {
    let total_price = document.getElementById('grand_total');
    let price = parseFloat(pricee); // Assuming the price is stored in the inner text of the element
    total_price.innerText = count * price; // Calculate and update the total price
  }
      // Render the PayPal button into #paypal-button-container

      paypal.Buttons({
          // Set up the transaction
          createOrder: function(data, actions) {
              return actions.order.create({
                  purchase_units: [{
                      amount: {
                          value: "10" // Hardcoded amount for demo purposes
                      }
                  }]
              });
          },

          // Finalize the transaction
          onApprove: function(data, actions) {
              return actions.order.capture().then(function(details) {
                  //alert('Transaction completed by ' + details.payer.name.given_name);
                  var formData = new FormData();
            formData.append("name", document.getElementById('name').value,);
            formData.append("Address", document.getElementById('Address').value,);
            formData.append("Pincode", document.getElementById('Pincode').value,);
            formData.append("Mobile_number", document.getElementById('Mobile_number').value,);
            formData.append("quantity", document.getElementById('quantity').value,);
            formData.append("grand_total", document.getElementById('grand_total').innerText,);
            formData.append("Product_id","{{order.id}}");
            
            $.ajax({
                type: 'POST',
                url: '/form_postpayment',
                data: formData,
                encode: true,
                dataType: 'json',
                processData: false,
                contentType: false,
            }).done(function(data) {
                if (data === "Done") {
                  location.reload();    
                }
               else if(data === "exists") {
                    $("#message").text("Invalid Data");
                }
            });
            
                  // Call your server to save the transaction
                  return fetch('/demo/checkout/api/paypal/order/' + data.orderID + '/capture/', {
                      method: 'post'
                  }).then(function(res) {
                      return res.json();
                  }).then(function(orderData) {
                      console.log('Capture result', orderData, JSON.stringify(orderData, null, 2));
                  });
              });
          }

      }).render('#paypal-button-container');  
</script>
